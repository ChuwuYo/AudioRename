<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AudioRename</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* è®¾ç½®bodyèƒŒæ™¯è‰²ï¼Œç«‹å³æ¶ˆé™¤ç™½å± */
        body {
            margin: 0;
            padding: 0;
            background-color: #FFFBFE;
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
    </style>

    <!-- ç›´æ¥åŠ è½½CSSï¼Œé¿å…å¼‚æ­¥å¯¼è‡´çš„æ ·å¼é—®é¢˜ -->
    <link rel="stylesheet" href="styles.css">

    <!-- ç›´æ¥åŠ è½½å­—ä½“ï¼Œç¡®ä¿å­—ä½“æ­£å¸¸å·¥ä½œ -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <h1><span class="icon" aria-hidden="true">âœ¨</span> éŸ³é¢‘æ–‡ä»¶é‡å‘½åå·¥å…· <span class="icon" aria-hidden="true">âœ¨</span></h1>

        <div id="controls">
            <button id="select-dir-btn">
                <span class="icon" aria-hidden="true">ğŸ“</span>
                é€‰æ‹©ç›®å½•
            </button>
            <button id="select-files-btn">
                <span class="icon" aria-hidden="true">ğŸ“„</span>
                é€‰æ‹©æ–‡ä»¶
            </button>
            <button id="rename-btn" disabled>
                <span class="icon" aria-hidden="true">ğŸš€</span>
                å¼€å§‹é‡å‘½å
            </button>
        </div>

        <div class="rename-pattern-container">
            <label for="rename-pattern-button">å‘½åæ¨¡å¼:</label>
            <div class="custom-dropdown-container">
                <button class="dropdown-trigger" type="button" id="rename-pattern-button" aria-haspopup="menu"
                    aria-expanded="false" data-state="closed" data-value="artist-title">
                    <span id="selected-pattern-text">è‰ºæœ¯å®¶ - æ­Œæ›²å (é»˜è®¤)</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="dropdown" aria-hidden="true">
                        <path d="m6 9 6 6 6-6"></path>
                    </svg>
                </button>

                <div class="dropdown-content" id="rename-pattern-dropdown">
                    <div class="dropdown-item selected" data-value="artist-title">è‰ºæœ¯å®¶ - æ­Œæ›²å (é»˜è®¤)</div>
                    <div class="dropdown-item" data-value="title-artist">æ­Œæ›²å - è‰ºæœ¯å®¶å</div>
                    <div class="dropdown-item" data-value="indexed-artist-title">åºå·. è‰ºæœ¯å®¶ - æ­Œæ›²å</div>
                    <div class="dropdown-item" data-value="indexed-title-artist">åºå·. æ­Œæ›²å - è‰ºæœ¯å®¶å</div>
                </div>
            </div>
        </div>

        <div class="section-card">
            <h2><span class="icon" aria-hidden="true">ğŸ“‹</span>å¾…å¤„ç†æ–‡ä»¶:</h2>
            <div class="file-filter-buttons">
                <button id="filter-all-btn" class="filter-btn active">
                    <span class="icon" aria-hidden="true">ALL</span>
                </button>
                <button id="filter-standard-btn" class="filter-btn">
                    <span class="icon" aria-hidden="true">âœ“</span>
                </button>
                <button id="filter-nonstandard-btn" class="filter-btn">
                    <span class="icon" aria-hidden="true">âœ—</span>
                </button>
            </div>
            <div id="fileList"></div>
        </div>

        <div class="section-card">
            <h2><span class="icon" aria-hidden="true">ğŸ“œ</span>æ—¥å¿—:</h2>
            <div id="log"></div>
        </div>
    </div>

    <!-- å†…è”å…³é”®JavaScript -->
    <script>
        // åˆå§‹åŒ–è‡ªå®šä¹‰ä¸‹æ‹‰é€‰æ‹©æ¡†çš„äº¤äº’é€»è¾‘
        function initializeCustomDropdown() {
            const dropdownTrigger = document.getElementById('rename-pattern-button');
            const dropdownContent = document.getElementById('rename-pattern-dropdown');
            const selectedPatternText = document.getElementById('selected-pattern-text');
            const dropdownItems = dropdownContent.querySelectorAll('.dropdown-item');

            function toggleDropdown() {
                const isOpen = dropdownTrigger.getAttribute('aria-expanded') === 'true';
                if (isOpen) {
                    dropdownTrigger.setAttribute('aria-expanded', 'false');
                    dropdownTrigger.dataset.state = 'closed';
                    dropdownContent.classList.remove('open');
                } else {
                    dropdownTrigger.setAttribute('aria-expanded', 'true');
                    dropdownTrigger.dataset.state = 'open';
                    dropdownContent.classList.add('open');
                }
            }

            function closeDropdown() {
                dropdownTrigger.setAttribute('aria-expanded', 'false');
                dropdownTrigger.dataset.state = 'closed';
                dropdownContent.classList.remove('open');
            }

            function selectItem(item) {
                const value = item.dataset.value;
                const text = item.textContent;

                dropdownItems.forEach(i => i.classList.remove('selected'));
                item.classList.add('selected');

                selectedPatternText.textContent = text;
                dropdownTrigger.dataset.value = value;

                const event = new CustomEvent('rename-pattern-change', {
                    detail: { value, text }
                });
                dropdownTrigger.dispatchEvent(event);

                closeDropdown();
            }

            dropdownTrigger.addEventListener('click', toggleDropdown);

            dropdownItems.forEach(item => {
                item.addEventListener('click', () => selectItem(item));
            });

            document.addEventListener('click', (event) => {
                if (!dropdownTrigger.contains(event.target) && !dropdownContent.contains(event.target)) {
                    closeDropdown();
                }
            });

            dropdownTrigger.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' || event.key === ' ') {
                    event.preventDefault();
                    toggleDropdown();
                } else if (event.key === 'Escape') {
                    closeDropdown();
                }
            });

            dropdownItems.forEach(item => {
                item.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter' || event.key === ' ') {
                        event.preventDefault();
                        selectItem(item);
                    }
                });
            });
        }

        document.addEventListener('DOMContentLoaded', initializeCustomDropdown);
    </script>

    <!-- å¼‚æ­¥åŠ è½½ä¸»è¦JavaScript -->
    <script src="renderer.js" defer></script>
</body>

</html>